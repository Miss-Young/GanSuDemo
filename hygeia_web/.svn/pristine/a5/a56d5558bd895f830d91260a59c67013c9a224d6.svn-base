$.fn.PowerPrint=function(a){a=$.extend({},{},a);var b=$(this);a=new PowerPrintManager(b,a);PowerPrintManager.currentObj=a;a.init();return a};var PowerPrintManager=function(a,b){this.$target=a;this.opts=b;this.labels=[]};
PowerPrintManager.prototype={init:function(){var a=this.$target.find("#print_format");if("undefined"!=typeof a[0]){var b="",c="",d=this;a.find("span").each(function(){var a=$(this).attr("id");"head"==a?b=$(this).html():"foot"==a?c=$(this).html():"label"==a&&d.labels.push($(this).text())});if(0==this.$target.find("table").find("thead").length){var g=this.$target.find("table"),h=$("<thead></thead>");h.insertBefore(this.$target.find("table tbody"));var f=b.split(","),e=0;for(i in f)e<f[i]-1&&(e=f[i]-
1);for(i=0;i<=e;i++)h.append(g.find("tr:eq("+i+")"))}if(0==this.$target.find("table").find("tfoot").length&&!/^ *&/.test(c)&&""!=c){g=this.$target.find("table");h=$("<tfoot></tfoot>");g.append(h);var k=c.split(","),f=g.find("tr").length,e=f-1;for(i in k)isNaN(k[i])||e>k[i]-1&&(e=k[i]-1);k=[];for(i=e;i<f;i++)k.push(g.find("tr:eq("+i+")"));for(i=0;i<k.length;i++)h.append(k[i])}a.remove()}},print_init:function(a,b,c){PowerPrintManager.currentObj=this;if("undefined"==typeof a||null==a)a=!0;if("undefined"==
typeof b||null==b)b=!1;if("undefined"==typeof c||null==c)c="";LODOP=getLodop();LODOP.PRINT_INITA(10,10,1E3,1E3,this.opts.name);b?(LODOP.ADD_PRINT_SETUP_BKIMG('<img border="1" src="'+c+'">'),LODOP.SET_SHOW_MODE("SETUP_IN_BROWSE",1),LODOP.SET_SHOW_MODE("BKIMG_IN_PREVIEW",1),LODOP.SET_SHOW_MODE("DESIGN_IN_BROWSE",1)):a?LODOP.ADD_PRINT_TABLE("5mm","5mm","RightMargin:0.5cm","BottomMargin:5mm",this.$target.html()):LODOP.ADD_PRINT_HTM("5mm","5mm","RightMargin:0.5cm","BottomMargin:5mm",this.$target.html());
for(n=0;n<this.labels.length;n++)this.addLabel(LODOP,this.labels[n],b);LODOP.On_Return=this.On_Return;return LODOP},addLabel:function(a,b,c){if("undefined"==typeof c||null==c)c=!1;if(/^#label/i.test(b)&&(b=b.match(/\( *".*(?= *\))/),null!=b&&(b=b[0].match(/\w.*/),null!=b))){var d=b[0].split(",");b=d[0].match(/[a-z]+/gi);var g=d[1].match(/\d+/),h=d[2].match(/\d+/),f=d[3].match(/\d+/),e=d[4].match(/\d+/),d=d[5].replace(/"/g,"");c?a.ADD_PRINT_TEXT(g,h,f,e,d):a.ADD_PRINT_TEXT(h,g,f,e,d);for(i=0;i<b.length;i++)b[i].match(/top/i)&&
a.SET_PRINT_STYLEA(0,"Vorient",0),b[i].match(/left/i)&&a.SET_PRINT_STYLEA(0,"Horient",0),b[i].match(/right/i)&&a.SET_PRINT_STYLEA(0,"Horient",1),b[i].match(/bottom/i)&&a.SET_PRINT_STYLEA(0,"Vorient",1),b[i].match(/middle/i)&&a.SET_PRINT_STYLEA(0,"Vorient",2),b[i].match(/center/i)&&a.SET_PRINT_STYLEA(0,"Horient",2),b[i].match(/page/i)&&a.SET_PRINT_STYLEA(0,"ItemType",2)}},On_Return:function(a,b){a="string"==typeof b?isNaN(parseInt(b,10))?0:b:b?1:0;"undefined"!=typeof PowerPrintManager.currentObj&&
"undefined"!=typeof PowerPrintManager.currentObj.opts.printCallback&&PowerPrintManager.currentObj.opts.printCallback(a)},preview:function(a,b,c){LODOP=this.print_init(a,b,c);LODOP.SET_SHOW_MODE("PREVIEW_NO_MINIMIZE",!0);LODOP.PREVIEW()},print:function(a,b,c,d){LODOP=this.print_init(b,c,d);LODOP.SET_SHOW_MODE("PREVIEW_NO_MINIMIZE",!0);1==a?LODOP.PRINTA():LODOP.PRINT()},setup:function(a,b,c){LODOP=this.print_init(a,b,c);LODOP.SET_SHOW_MODE("PREVIEW_NO_MINIMIZE",!0);LODOP.PRINT_SETUP()},design:function(a,
b,c){LODOP=this.print_init(a,b,c);LODOP.SET_SHOW_MODE("PREVIEW_NO_MINIMIZE",!0);LODOP.PRINT_DESIGN()}};